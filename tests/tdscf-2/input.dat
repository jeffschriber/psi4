UHF_TDA_cc_pvdz = [0.24880026306449304,
                   0.28968755925744966,
                   0.32054964027744337,
                   0.35741288565867185,
                   0.39502214228627547,
                   0.41144173957102564,
                   0.4445528791268893,
                   0.4535932124573471,
                   0.48482278670215617]

molecule ch2 {
0 3

C           0.000000    0.000000    0.159693
H          -0.000000    0.895527   -0.479080
H          -0.000000   -0.895527   -0.479080
no_reorient
no_com
symmetry c1
}

set {
    reference uhf
    scf_type pk
    e_convergence 8
    d_convergence 8
    TDSCF_E_TOL 5
    TDSCF_STATES_PER_IRREP [9]
    TDSCF_TRIPLETS true
    TDSCF_TDA true
}

e, wfn = energy('hf/cc-pvdz', return_wfn=True)

ex_ens = np.asarray(wfn.array_variable("TD-HF EXCITATION ENERGIES")).flatten()
ex_labels = np.asarray(wfn.array_variable("TD-HF SYMMETRY LABELS")).flatten()

for n, ref in enumerate(UHF_TDA_cc_pvdz):
    compare_values(ref,ex_ens[n], 4, f"TD-UHF/cc-pvdz (RPA) 0 A -> {n} A Excitation Energy")
